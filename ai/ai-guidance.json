{
  "project": {
    "name": "vld",
    "version": "0.1.0",
    "slogan": "极致性能前端框架",
    "currentModuleId": "reactivity",
    "lastUpdated": "2025-12-20T10:00:00Z",
    "fileExtension": ".vue",
    "vueCompatibility": "完全兼容Vue3语法和生态"
  },

  "corePrinciples": {
    "performance": ["不使用虚拟DOM", "Signal细粒度更新", "包体积<10KB gzip", "多线程渲染", "视口优先渲染"],
    "architecture": ["零运行时依赖", "支持Tree-shaking", "只支持现代浏览器", ".vue文件扩展名", "模块可单独引入"],
    "optimization": ["AOT预编译", "静态提升/常量折叠", "组件动态import", "深度集成Vite", "时间切片/虚拟滚动"]
  },

  "qualityRules": {
    "typeSafety": "TypeScript严格模式",
    "noDeadCode": "不声明未使用变量",
    "correctExports": "跨模块变量正确导出",
    "performanceFirst": "决策考虑性能影响",
    "memorySafe": "WeakMap/WeakSet，卸载清理"
  },

  "currentFocus": {
    "moduleId": "reactivity",
    "priority": 1,
    "targetFiles": ["signal.ts", "effect.ts", "computed.ts", "reactive.ts", "batch.ts", "scheduler.ts", "untracked.ts", "utils/equals.ts"],
    "performanceTarget": "Signal更新延迟<1ms"
  },

  "modules": {
    "reactivity": {
      "status": "pending",
      "priority": 1,
      "mission": "实现零虚拟DOM的细粒度更新系统",
      "files": {
        "signal.ts": {
          "status": "pending",
          "core": "Signal工厂函数，依赖收集",
          "perf": "signal创建<0.01ms，getter<0.001ms，setter<0.005ms",
          "requirements": ["导出createSignal/get/set", "自定义相等函数", "批量更新标记", "调试钩子", "导出activeEffect/effectStack"]
        },
        "effect.ts": {
          "status": "pending",
          "core": "副作用追踪，自动依赖收集",
          "requirements": ["导出createEffect/track/cleanup", "嵌套effect支持", "清理函数机制", "导入activeEffect/effectStack"]
        },
        "computed.ts": {
          "status": "pending",
          "core": "计算属性，惰性求值+缓存",
          "requirements": ["导出createComputed", "依赖自动追踪", "脏标记机制", "缓存未变值"]
        },
        "reactive.ts": {
          "status": "pending",
          "core": "Proxy响应式对象",
          "requirements": ["导出createReactive/isReactive", "深层属性响应式", "数组方法拦截", "WeakMap缓存"]
        },
        "batch.ts": {
          "status": "pending",
          "core": "批量更新系统",
          "requirements": ["导出batch/flushQueuedEffects", "嵌套batch支持", "微任务调度", "effect去重"]
        },
        "scheduler.ts": {
          "status": "pending",
          "core": "任务调度器，优先级队列+时间切片",
          "requirements": ["导出scheduleTask/cancelTask", "优先级队列", "requestIdleCallback时间切片", "降级策略"]
        },
        "untracked.ts": {
          "status": "pending",
          "core": "无依赖追踪读取",
          "requirements": ["导出untrack/batchUntracked", "嵌套untrack支持", "防止内存泄漏"]
        },
        "utils/equals.ts": {
          "status": "pending",
          "core": "深度值比较",
          "requirements": ["导出equals/shallowEquals", "Object.is快速比较", "深度比较", "循环引用检测"]
        }
      }
    },
    
    "router": {
      "status": "pending",
      "priority": 2,
      "mission": "类vue-router路由系统，极致性能优化",
      "skipDetails": true,
      "files": ["router.ts", "matcher.ts", "navigation-guards.ts", "scroll-behavior.ts", "history", "link.ts", "view.ts", "errors.ts"],
      "requirements": ["完全兼容vue-router 4.x API", "动态路由和嵌套路由", "路由守卫", "路由组件动态import"]
    },
    
    "compiler-core": {
      "status": "pending",
      "priority": 3,
      "mission": "模板→AST→高效JS代码，支持Vue3语法",
      "skipDetails": true,
      "files": ["parser.ts", "tokenizer.ts", "nodes.ts", "walker.ts", "optimizer.ts", "hoist.ts", "generator.ts", "context.ts"],
      "requirements": ["支持Vue3模板语法", "编译为直接DOM操作", "静态提升/常量折叠", "与Signal系统集成"]
    },
    
    "compiler-sfc": {
      "status": "pending",
      "priority": 4,
      "mission": ".vue单文件组件编译",
      "skipDetails": true,
      "files": ["parse.ts", "compileTemplate.ts", "compileScript.ts", "compileStyle.ts", "descriptor.ts", "cache.ts", "errors.ts"],
      "requirements": ["解析.vue文件", "模板编译", "支持TypeScript和setup语法", "scoped CSS", "HMR支持"]
    },
    
    "runtime-core": {
      "status": "pending",
      "priority": 5,
      "mission": "组件渲染和生命周期运行时引擎",
      "skipDetails": true,
      "multithreaded": "支持Web Worker多线程渲染",
      "files": ["renderer.ts", "patch.ts", "component.ts", "slots.ts", "vnode.ts", "scheduler.ts", "worker-renderer.ts", "error-boundary.ts"],
      "requirements": ["组件实例化/挂载/更新/卸载", "Web Worker多线程渲染", "视口内优先渲染", "错误边界", "插槽系统"]
    },
    
    "runtime-dom": {
      "status": "pending",
      "priority": 6,
      "mission": "DOM环境运行时适配器",
      "skipDetails": true,
      "files": ["create.ts", "events.ts", "attrs.ts", "props.ts", "class.ts", "style.ts", "transition.ts", "hydrate.ts"],
      "requirements": ["DOM元素创建", "事件处理系统", "属性处理", "样式处理", "过渡动画", "SSR水合"]
    },
    
    "vld-main": {
      "status": "pending",
      "priority": 7,
      "mission": "框架主入口和公共API",
      "skipDetails": true,
      "files": ["createApp.ts", "h.ts", "directives/", "components/", "plugins/", "config.ts", "global-api.ts"],
      "requirements": ["createApp应用实例", "h函数支持JSX", "内置指令", "内置组件", "插件系统", "全局API兼容Vue3"]
    },
    
    "vite-plugin": {
      "status": "pending",
      "priority": 8,
      "mission": "Vite插件，支持.vue文件热更新",
      "skipDetails": true,
      "files": ["index.ts", "handleHotUpdate.ts", "resolveId.ts", "load.ts", "transform.ts", "dev-server.ts", "build.ts"],
      "requirements": ["Vite插件钩子", "热模块替换", "开发服务器集成", "生产构建优化"]
    },
    
    "cli": {
      "status": "pending",
      "priority": 9,
      "mission": "项目脚手架和开发工具",
      "skipDetails": true,
      "files": ["create.ts", "dev.ts", "build.ts", "inspect.ts", "templates/", "utils/"],
      "requirements": ["项目创建模板", "开发服务器集成Vite", "生产构建优化", "项目检查工具"]
    },
    
    "devtools": {
      "status": "pending",
      "priority": 10,
      "mission": "浏览器扩展，调试和性能分析",
      "skipDetails": true,
      "files": ["inspector.ts", "timeline.ts", "component-inspector.ts", "performance-monitor.ts", "backend/", "frontend/"],
      "requirements": ["组件检查器", "性能时间线", "事件追踪", "内存分析", "浏览器扩展"]
    }
  },

  "aiOptimization": {
    "readingStrategy": [
      "1. 始终读取：project, corePrinciples, qualityRules, currentFocus",
      "2. 当前模块读取完整files细节",
      "3. 其他模块只读status/priority/mission/files数组",
      "4. skipDetails=true时只读files数组",
      "当前模块：reactivity"
    ],
    "generationStrategy": [
      "生成独立完整文件",
      "优先考虑性能",
      "添加详细注释",
      "支持多线程渲染",
      "确保无TypeScript错误",
      "跨模块共享变量正确导出"
    ]
  },

  "codeGenerationOrder": [
    {"module": "reactivity", "note": "基础依赖"},
    {"module": "router", "note": "可独立使用"},
    {"module": "compiler-core", "note": "依赖reactivity"},
    {"module": "compiler-sfc", "note": "依赖compiler-core"},
    {"module": "runtime-core", "note": "依赖reactivity+compiler-core，多线程渲染"},
    {"module": "runtime-dom", "note": "依赖runtime-core"},
    {"module": "vld-main", "note": "依赖前面所有模块"},
    {"module": "vite-plugin", "note": "依赖compiler-sfc"},
    {"module": "cli", "note": "依赖vld-main"},
    {"module": "devtools", "note": "依赖vld-main"}
  ]
}